<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8" />
	<title>Upload data</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/03d58ba9c7.js" crossorigin="anonymous"></script>
</head>
<body>
    <div id="heading">
        <h1>Import NFR quarter/emp data &ensp;</h1>
    </div>
    <div id="box1">
        <label for="myfile">Select a file:</label><br><br>
        <input type="file" id="myfile" name="myfile" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
    </div>
    <div id="status">
        <i class="fas fa-spinner fa-pulse" style="display: none;"></i>
    </div> 
    <span id="file-status"></span>
    <button id="upload">Upload</button>
    <div id="preview">
        <i class="far fa-frown"></i>
        <span id="message">No preview available</span>
        <table id="tab" border="2"></table>
    </div>
    <div id="box">
        <p><b>PS :-</b></p>
        <ul>
            <li>The uploaded file should be in <span style="color: red;">.csv</span> or <span style="color: red;">.xls(x)</span> format</li><br>
            <li>For <i>quarter master entry</i>, the column order should be:</li><br>
            <table border="1">
                <tr>
                    <th>Qtr_ID (optional)</th>
                    <th>Qtr_No</th>
                    <th>Qtr_type</th>
                    <th>Colony_code</th>
                    <th>Book_no</th>
                    <th>Page_no</th>
                    <th>Meter capacity (in KW) (optional)</th>
                </tr>       
            </table><br>
            <li>For <i>quarter occupancy entry</i>, the column order should be:</li><br>
            <table border="1">
                <tr>
                    <th>EmpNo</th>
                    <th>EmpName</th>
                    <th>Qtr_No</th>
                    <th>Colony_code</th>
                    <th>Occupation Date</th>
                    <th>Vacation Date (optional)</th>
                </tr>       
            </table><br>
            <li>For <i>employee master entry</i>, the column order should be:</li><br>
            <table border="1">
                <tr>
                    <th>EmpNo</th>
                    <th>Name</th>
                    <th>Designation</th>
                    <th>BillUnit</th>
                    <th>Station</th>
                    <th>DOR</th>
                </tr>       
            </table><br>
            <li>Before uploading data into <i>quarter occupancy</i> table, please make sure that the employee and quarter records are present in the <i>employee master</i> and <i>quarter master</i> tables respectively.</li><br>
            <li><b>Optional</b> fields, partly filled, will not be accepted. Files having optional fields should be separated.</li><br>
            <li>The qtr_type should be in roman numeral <b>(I,II,III,etc.)</b></li><br>
            <li>The dates should be in <span style="color: red;">general</span> format</li><br>
            <li>The column headers should be declared in the first row</li>
        </ul>
    </div>
    <script src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="code.js"></script>
</body>
</html>